# 5.1 파티셔너

- 프로듀서가 토픽으로 메시지를 보낼 때 해당 토픽의 어느 파티션으로 메시지를 보내야 할지를 결정해할 때 사용되는게 파티셔너이다.
- 프로듀서가 파티션을 결정하는 알고리즘은 기본적으로 메시지(레코드)의 키를 해시 처리해 파티션을 구하는 방식을 사용한다.
- 파티션을 늘리면 해시 테이블을 새로 작성하기 때문에 같은 키를 사용하더라도 다른 파티션에 할당될 가능성이 높다.

# 라운드 로빈 전략

- 메시지에 키값을 지정하지 않고 전송하면 기본값인 라운드 로빈 알고리즘을 사용해서 파티션을 할당한다.
- 파티셔너는 배치 처리를 통해 토픽으로 데이터를 전송한다.
- 만약 배치 사이즈가 3인데 1번 파티션에 데이터가 2개밖에 없다면 3개가 채워질때까지 계속 기다린다.( 파티션에 대해서 한 사이클 돌때까지 계속 대기해야함. )

# 스티키 파티셔닝 전략

- 라운드 로빈 전략에서 지연시간이 불필요하게 증가되는 비효율적인 전송을 개선하고자 등장했다.
- 하나의 파티션에 레코드 수를 먼저 채워서 카프카로 빠르게 배치 전송하는 전략이다.
- 라운드 로빈에 비해 30% 이상 지연시간이 감소하는 효과를 얻을 수 있다.
- 카프카로 전송하는 세미지의 순서가 그다지 중요하지 않은 경우라면 스티키 파티셔닝 전략을 사용하는게 좋다.
